<!DOCTYPE html>
<html>
<head>
    <title>JavaScript &amp; jQuery - Chapter 6: Events - Mutation Events</title>
    <link rel="stylesheet" href="css/c06.css"/>
</head>
<body>
<div id="page">
    <h1>List King</h1>
    <h2>Buy Groceries <span id="counter">1</span></h2>
    <ul id="list">
        <li>fresh figs</li>
    </ul>
    <div class="button"><a href="/additem" class="add">Add list item</a></div>
</div>
<script>
    var elList, addLink, newEl, newText, counter, listItems; // Declare variables

    elList = document.getElementById('list');               // Get list
    addLink = document.querySelector('a');                   // Get add item button
    counter = document.getElementById('counter');            // Get item counter

    function addItem(e)
    {                                    // Declare function
        e.preventDefault();                                    // Prevent link action
        newEl = document.createElement('li');                  // New <li> element
        newText = document.createTextNode('New list item');    // New text node
        newEl.appendChild(newText);                            // Add text to <li>
        elList.appendChild(newEl);                             // Add <li> to list
    }

    function updateCount()
    {                                 // Declare function
        listItems = elList.getElementsByTagName('li').length;  // Get total of <li>s
        counter.innerHTML = listItems;                         // Update counter
    }

    addLink.addEventListener('click', addItem, false);       // Click on button
    elList.addEventListener('DOMNodeInserted', updateCount, false); // DOM updated
</script>
</body>
</html>